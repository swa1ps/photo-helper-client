(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{148:function(e,t,a){e.exports=a(199)},186:function(e,t,a){},192:function(e,t){},193:function(e,t){},194:function(e,t){},195:function(e,t){},196:function(e,t){},197:function(e,t){},199:function(e,t,a){"use strict";a.r(t);a(149),a(174);var n=a(1),i=a.n(n),r=a(21),l=a.n(r),c=a(79),o=a.n(c),s=a(37),u=a(38),d=a(42),m=a(39),f=a(43),h=a(6),v=(a(185),a(85)),g=a.n(v),p=a(40),E=a.n(p),b=function(e){var t=e.id,a=e.go,n=e.onFileChange;return i.a.createElement(h.f,{id:t},i.a.createElement(h.g,null,"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"),i.a.createElement(h.d,{title:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438"},i.a.createElement(h.b,null,i.a.createElement(h.c,{top:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",before:i.a.createElement(g.a,null),size:"xl",level:"secondary",onChange:n},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b")),i.a.createElement(h.b,null,i.a.createElement(h.a,{before:i.a.createElement(E.a,null),size:"xl",level:"2",onClick:a,"data-to":"persik"},"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0444\u043e\u0442\u043e"))))},w=(a(186),a(86)),P=a.n(w),x=a(41),C=a.n(x),R=a(87),j=a.n(R),k=a(88),F=(a(200),a(89)),O=a.n(F),y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).videoRef=i.a.createRef(),a.canvasRef=i.a.createRef(),a.detectFrame=function(e,t){t.detect(e).then(function(n){var i=n.filter(function(e){return"person"===e.class}),r=!!i.length;a.setState({hasPerson:r}),a.renderPredictions(i),requestAnimationFrame(function(){a.detectFrame(e,t)})})},a.renderPredictions=function(e){var t=a.canvasRef.current.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height);var n="16px sans-serif";t.font=n,t.textBaseline="top",e.forEach(function(e){var a=e.bbox[0],i=e.bbox[1],r=e.bbox[2],l=e.bbox[3];t.strokeStyle="red",t.lineWidth=4,t.strokeRect(a,i,r,l),t.fillStyle="red";var c=t.measureText(e.class).width,o=parseInt(n,10);t.fillRect(a,i,c+15,o+4)}),e.forEach(function(e){var a=e.bbox[0],n=e.bbox[1];t.fillStyle="#000000",t.fillText("\u0427\u0435\u043b\u043e\u0432\u0435\u043a",a,n)})},a.state={isLoading:!0,hasPerson:!1},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new O.a(window.navigator.userAgent);if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:t.mobile()?{exact:"environment"}:"user"}}).then(function(t){return window.stream=t,e.videoRef.current.srcObject=t,new Promise(function(t,a){e.videoRef.current.onloadedmetadata=function(){t()}})}),n=k.a();Promise.all([n,a]).then(function(t){e.detectFrame(e.videoRef.current,t[0])}).catch(function(e){console.error(e)}).finally(function(){e.setState({isLoading:!1})})}}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.go,n=e.onFileChange,r=this.state,l=r.hasPerson,c=r.isLoading,o=l?j.a:E.a,s=l?"\u0421\u0420\u041e\u0427\u041d\u041e \u0423\u0411\u0415\u0420\u0418\u0422\u0415 \u041b\u042e\u0414\u0415\u0419!!!!!!":"\u0421\u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0440\u043e\u0432\u0430\u0442\u044c";return i.a.createElement(h.f,{id:t},i.a.createElement(h.g,{left:i.a.createElement(h.e,{onClick:a,"data-to":"home"},i.a.createElement(C.a,null))},"\u0421\u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0440\u043e\u0432\u0430\u0442\u044c"),i.a.createElement(h.d,null,c?i.a.createElement("div",{className:"Preloader"},i.a.createElement(h.h,{className:"Spinner"})," ",i.a.createElement("span",null,"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043f\u043e\u043c\u043e\u0449\u043d\u0438\u043a\u0430")):i.a.createElement(h.c,{size:"xl",level:"2",onChange:n,before:i.a.createElement(o,null),disabled:l,accept:"image/*;capture=camera"},s),i.a.createElement("section",{className:"Wrapper"},i.a.createElement("video",{autoPlay:!0,playsInline:!0,muted:!0,ref:this.videoRef,width:"400",height:"400"}),i.a.createElement("canvas",{className:"Canvas",ref:this.canvasRef,width:"400",height:"400"}),l&&i.a.createElement("img",{src:P.a,className:"NoPls"}))))}}]),t}(i.a.Component),L=function(e){var t=e.id,a=e.go,n=e.preview,r=e.result,l=e.isLoading;return i.a.createElement(h.f,{id:t},i.a.createElement(h.g,{left:i.a.createElement(h.e,{onClick:a,"data-to":"home"},i.a.createElement(C.a,null))},"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442"),(l||r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(h.d,{title:"\u0421\u0442\u0430\u043b\u043e"},l&&i.a.createElement("div",{className:"Preloader"},i.a.createElement(h.h,{className:"Spinner"})," ",i.a.createElement("span",null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430")),!l&&r&&i.a.createElement("img",{className:"Preview",src:r,alt:"\u0441\u0442\u0430\u043b\u043e"}))),n&&i.a.createElement(h.d,{title:"\u0411\u044b\u043b\u043e"},i.a.createElement("img",{className:"Preview",src:n,alt:"\u0431\u044b\u043b\u043e"})))},S="https://api-government-dev.itlabs.io/etagi-sale/photo/api/photo_process",N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChangeFile=function(e){var t=e.target.files[0],n=new FormData;n.append("photo",t),a.setState({isLoading:!0,preview:URL.createObjectURL(t),activePanel:"result"}),fetch(S,{method:"POST",body:n}).then(function(e){return e.json()}).then(function(e){a.setState({isLoading:!1,result:e.link})})},a.go=function(e){a.setState({activePanel:e.currentTarget.dataset.to})},a.state={activePanel:"home",isLoading:!1,result:null,preview:null},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.result,a=e.preview,n=e.isLoading;return i.a.createElement(h.i,{activePanel:this.state.activePanel},i.a.createElement(b,{id:"home",go:this.go,onFileChange:this.handleChangeFile}),i.a.createElement(y,{id:"persik",onFileChange:this.handleChangeFile,go:this.go}),i.a.createElement(L,{id:"result",go:this.go,result:t,preview:a,isLoading:n}))}}]),t}(i.a.Component);o.a.send("VKWebAppInit",{}),l.a.render(i.a.createElement(N,null),document.getElementById("root"))},86:function(e,t,a){e.exports=a.p+"static/media/noPls.8b01e801.png"}},[[148,1,2]]]);
//# sourceMappingURL=main.bf1f0d73.chunk.js.map